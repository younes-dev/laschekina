{% extends 'FrontBundle::layout.html.twig' %}

{% block title %}  {{ 'page.collection'|trans }}{% endblock %}
 
{% block stylesheets %}
    <link rel="stylesheet" href="{{ asset('assets/css/personnage.css') }}">
    
    <script src="https://use.fontawesome.com/fe459689b4.js"></script>
{% endblock %}
{% block imgscreen %}
<div class="channel-cover">

    <div class="bg-post">

        <div class="img-resize imgLiquid">

            {% if member.picturecover != null %}
                <img src="{{ path_picture ~ member.picturecover }}">
            {% else %}
                <img src="{{ path_picture|getImageDefault()}}">
            {% endif %}

        </div>
    </div>
{% endblock %}
{% block body %}
<div class="author-overlay container">
        <div class="channel-header">
            <div class="author-avatar img-resize imgLiquid">
                {% if member.pictureprofil != null %}
                    <img src="{{ path_picture ~ member.pictureprofil }}" class="avatar-acteur">
                {% else %}
                    <img src="{{ asset('assets/images/avatar.png') }}" class="avatar-acteur">
                {% endif %}

            </div>
            <div class="author-meta">
                <h3 class="author-name">
                 
              
                {% if  member.fan == 1 %}   <i class="zmdi zmdi-accounts-alt"></i>&nbsp; {% endif %} 
                
                {{  member.prenom ~" "~  member.nom }}
                {% if  member.roles[0] == "ROLE_VIP"  and  member.fan == 0  %}
                        {% set numbre_etoile = 0 %}
                        {% if  member.id|countNbrFans  > 0  %}
                        {% set numbre_etoile = 1 %}
                        {% elseif  member.id|countNbrFans  > 10000  %}
                        {% set numbre_etoile = 2 %}
                        {% elseif  member.id|countNbrFans  > 100000  %}
                        {% set numbre_etoile = 3 %}
                        {% elseif  member.id|countNbrFans  > 1000000  %}
                            {% set numbre_etoile = 4 %}
                    
                        {% endif %}
                        {% if numbre_etoile > 0 %}
                    {% for i in 1..numbre_etoile %}
                    <i class="zmdi zmdi-star" style="color: yellow;margin-left: 1px;"></i>
                    {% endfor %}
                        {% endif %}
                {% endif %}
    
                </h3>
                {#  <div class="rating">
                      <ul class="star-rating">
                          <li class="rating check"></li>
                          <li class="rating check"></li>
                          <li class="rating"></li>
                          <li class="rating"></li>
                          <li class="rating"></li>
                      </ul>
                  </div>
          #}    </div>
        </div>
    </div>
</div>
    <div class="content-page inner-xs ">
        <div class="container">
            <div class="row">
                <div class="col-md-9 col-sm-9 col-xs-12">
                    {% if app.user != null and member.id == app.user.id %}
                    <div class="row">
                        <div class="col-md-12 col-sm-12 col-xs-12 box-page-bg clearfix">
                            {{ form_start(form, {'attr' : {'enctype' : 'multipart/form-data'} }) }}
                                <div class="form-group clearfix" >
                                    <div class="col-md-12 mag-bttom-sm">
                                        <label class="label-control">{{ 'btn.personnage'|trans }}</label>

                                        <input type="text" name="backbundle_personnagemedia[personnage]" maxlength="255" class="form-control " required="true">
                                    </div>
                                </div>

                                <div class="form-group clearfix">
                                    <div class="col-md-12 mag-bttom-sm">
                                        <input type="file" name="backbundle_personnagemedia[image]"
                                            data-field-type="bootstrap-file-filed"
                                            data-file-types="image/jpeg,image/png,image/gif"
                                            data-preview="on">

                                    </div>
                                </div>



                                <div class="form-group clearfix" >
                                    <div class="col-md-12 mag-bttom-sm">
                                        <label class="label-control">{{ 'form.description'|trans }} </label>
                                        <textarea name="backbundle_personnagemedia[description]" rows="4" class="form-control"></textarea>
                                    </div>


                                </div>

                                <div class="form-group">

                                    <div class="login-button col-md-8 ">

                                        <input type="submit" class="btn btn-orange" name="ajouter" value="{{ 'btn.add'|trans }}">
                                    </div>

                                </div>
                                {% do form.personnage.setRendered %}
                                {% do form.description.setRendered %}
                                {% do form.image.setRendered %}
                            {{ form_end(form) }}
                        </div><!--//end box-page-bg-->
                    </div>
                    {% endif %}
                    <div class="row personnage">
                        <div class="col-md-12 box-page-bg" id="personnage-list">
                            {% for personnage in personnageMediaList %}
                                <div class="post-news clearfix" id="{{ personnage.id }}">
                                    <div class="col-md-4 col-sm-4 col-xs-12 ">
                                        <div class="image-holder-content">
                                            <a href="{{ path('front_end_personnage_profile',{'activeTab': "profile" , 'id' : personnage.id }) }}" >
                                    <div class="small-photo-vip img-resize imgLiquid" >
                                                <img src="{% if personnage.image != '' and personnage.image is not null  %}{{ path_picture ~ 'personnage_media/' ~ personnage.image }}{% else %}{{ path_no_image ~ 'assets/images/no-image.jpg' }}{% endif %}" >
                                            </div>
                                                </a>
                                        </div>
                                    </div>

                                    <div class="col-md-8 col-sm-8 col-xs-12">
                                   <div class="post-news-content">
                                    <h4 id="personnage-name-{{ personnage.id }}"> 
                                    <a href="{{ path('front_end_personnage_profile',{ 'activeTab': 'profile' , 'id' : personnage.id }) }}">{{ personnage.personnage }}</a>

                                        {% if app.user != null and member.id == app.user.id %}
                                            {% if personnage.beauxPersonnages == 0  %}
                                                {% set message =  'btn.remove_beaux_personnages'  %}
                                            {% else %}

                                                {% set message =  'btn.add_beaux_personnages'  %}

                                            {% endif %}
                                            <a style="padding: 5px 22px 5px 7px;margin-left: 15px; color: #FFFFFF " onclick="beauxPersonnages({{ app.user.id }} , '{{ message|trans }}' , {{ personnage.id }})" class="btn btn-orange  btn-lg" id="beauxPersonnages{{ personnage.id }}" name="submit" >
                                                {% if personnage.beauxPersonnages == 0  %}
                                                    {{ 'btn.add_beaux_personnages'|trans }}
                                                {% else %}
                                                    {{ 'btn.remove_beaux_personnages'|trans }}                                              {% endif %}
                                            </a>
                                        {% endif %}
                                    </h4>

                                    <p id="personnage-description-{{ personnage.id }}">
                                         {{ personnage.description[:200] }} {% if  personnage.description|length > 200 %}... {% endif %} 
                                    </p>
  
                                    
                                    <div class="vote col-md-12 col-sm-12 col-xs-12">
                                     
                                        <div class=" col-md-3 col-sm-12 col-xs-12" style="float: right;padding-top: 17px;">
                                        <div class="vote-bar">
                                            <div class="vote-progress"></div>
                                        </div>
                                        <div class="votes-btns">
                                            <button class="vote-btn vote-like" style="{% for vote in personnage.personnageVotes %}{% if app.user != null and vote.user.id == app.user.id and vote.vote == 1 %}color:green; {% set break = true %}{% endif %}{% endfor %}" id="like{{ personnage.id }}" onclick="likeDislike(1, {{ personnage.id }}, {% if app.user != null %}{{ app.user.id }}{% else %}null{% endif %})"><i class="fa fa-thumbs-up font-size"></i> <span id="nbr_like_{{ personnage.id }}">{{ personnage.id|countNbrLikePersonnage }}</span></button>
                                   {#         <button class="vote-btn vote-dislike" style="{% for vote in personnage.personnageVotes %}{% if app.user != null and vote.user.id == app.user.id and vote.vote == 0 %}color:red; {% set break = true %}{% endif %}{% endfor %}" id="dislike{{ personnage.id }}" onclick="likeDislike(0, {{ personnage.id }}, {% if app.user != null %}{{ app.user.id }}{% else %}null{% endif %})" ><i class="fa fa-thumbs-down font-size"></i> <span id="nbr_dislike_{{ personnage.id }}">{{ personnage.id|countNbrDislikePersonnage }}</span></button>
                                   #}     </div>
                                        </div>
                                    </div>
                                </div>
                                </div>
                                </div>
                            {% endfor %}
                        </div><!--//end col-md-9-->
                    </div><!--//end row-->
                </div><!--//end col-md-9-->
                <div class="col-md-3 col-sm-3  col-xs-12 mag-bot-40 ">

                    <div class="box-page-bg clearfix">

                        {% include 'MembreBundle:Collection:tourne.html.twig' %}
                    </div>
                    {% if member.twitter != null %}
                            <div class="box-page-bg clearfix">

                                <a class="twitter-timeline"   data-height="430"  href="https://twitter.com/{{ member.twitter }}" >Tweets </a>
                            </div>
                    {% endif %}
                    {{ render(controller('FrontBundle:Template:pub' )) }}

                </div>
            </div><!--//end row-->
        </div><!--//end container-->
    </div><!--//end content-page-->

    <!--Modal-->
    {% include 'MembreBundle:Collection:modal_personnage.html.twig' %}
{% endblock %}

{% block javascripts %}

    <script src="{{ asset('assets/js/personnage.js') }}"></script>
{% endblock %}